(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{186:function(t,a,e){var r={"./0_PIUs_gestao_urbana.rar":[214,0],"./10_PIUs_gestao_urbana_10NU.rar":[215,6],"./11_PIUs_gestao_urbana_11AC.rar":[216,7],"./12_PIUs_gestao_urbana_12ACP.rar":[217,8],"./16_PIUs_gestao_urbana_16BT.rar":[218,9],"./17_PIUs_gestao_urbana_17CAP.rar":[219,10],"./18_PIUs_gestao_urbana_18CL.rar":[220,11],"./19_PIUs_gestao_urbana_19PI.rar":[221,12],"./1_PIUs_gestao_urbana_1RB.rar":[222,13],"./20_PIU_Minhocao.rar":[223,14],"./21_PIU_Jockey_Club.rar":[224,15],"./22_PIU_Ginasio_do_Ibirapuera.rar":[225,16],"./2_PIUs_gestao_urbana_2VL.rar":[226,17],"./3_PIUs_gestao_urbana_3ACT.rar":[227,18],"./4_PIUs_gestao_urbana_4NESP.rar":[228,19],"./5_PIUs_gestao_urbana_5ACJ.rar":[229,20],"./7_PIUs_gestao_urbana_7ANH.rar":[230,21],"./8_PIUs_gestao_urbana_8PAC.rar":[231,22],"./9_PIUs_gestao_urbana_9VO.rar":[232,23]};function o(t){if(!e.o(r,t))return Promise.resolve().then((function(){var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}));var a=r[t],o=a[0];return e.e(a[1]).then((function(){return e(o)}))}o.keys=function(){return Object.keys(r)},o.id=186,t.exports=o},235:function(t,a,e){"use strict";e.r(a);var r="https://spurb.github.io/piu-monitoramento-preview/";e.e(0).then(e.bind(null,214));var o=[new ol.layer.Tile({source:new ol.source.BingMaps({imagerySet:"CanvasGray",culture:"pt-BR",key:"efIeX8pQ5PTC2IcEjuVT~s7zLBU5z6I20qWhPhkAy3w~AlgB9eABTaOsOC8LVDJEQhyb4ik0B0mWBpIfDgrVwNYVqgfnxOsXFN3_8XKZlP1d"})})],n={name:"mapa",props:{clickedId:{type:Number,required:!0},projetos:{type:Array,default:function(){return[]}},tramitacao:{type:Array,required:!0}},data:function(){return{loading:!0,mapa:{},view:new ol.View({projection:ol.proj.get("EPSG:3857"),center:[-5195135.816167192,-2698303.8770360295],zoom:10.9,minZoom:10.9,maxZoom:19}),activeLayers:[],center:[],breadcrumb:!1,fileDir:r}},computed:{projetoSelecionado:function(){var t=this;return this.projetos.length&&this.clickedId?this.projetos.find((function(a){return a.id===t.clickedId})):{id:0,nome:"Base"}},tramitacaoProjetoSelecionado:function(){var t=this;return this.projetoSelecionado.id_tramitacao?this.tramitacao.find((function(a){return a.id===t.projetoSelecionado.id_tramitacao})):{id:0,nome:"Base"}},kmlSrc:function(){return 0===this.clickedId?"0_PIUs_gestao_urbana.kml":"".concat(this.projetoSelecionado.kml)},shpSrc:function(){return 0===this.clickedId?"0_PIUs_gestao_urbana.rar":"".concat(this.projetoSelecionado.shape)}},mounted:function(){var t,a,e=this;this.mapa=(t=this.view,a=o,new ol.Map({target:"map",layers:a,loadTilesWhileAnimating:!0,view:t,controls:ol.control.defaults({attributionOptions:{collapsible:!1}}).extend([new ol.control.ScaleLine])})),fetch("api/BASE_Limite_MSP.kml").then((function(t){return new ol.layer.Vector({style:new ol.style.Style({stroke:new ol.style.Stroke({color:"black",width:.75}),fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0)"})}),source:new ol.source.Vector({url:t.default,format:new ol.format.KML({extractStyles:!1})})})})).then((function(t){return e.mapa.addLayer(t)})).finally((function(){e.loading=!1,e.applyMultiplyOnCanvas(),e.applyValuesInData()}))},watch:{projetos:function(t){t.length&&(t.map((function(t){return fetch("api/".concat(t.kml)).then((function(t){return t}))})).filter((function(t){return"18_PIUs_gestao_urbana_18CL.kml"!==t.kml})),t.map((function(t){return e(186)("./".concat(t.shape))})).filter((function(t){return"18_PIUs_gestao_urbana_18CL.kml"!==t.kml})),this.initMapLayers(t.filter((function(t){return"18_PIUs_gestao_urbana_18CL.kml"!==t.kml}))))},clickedId:function(t,a){t?(this.view.cancelAnimations(),this.fitToLayer(t),this.toggleLayersStyles(t),this.breadcrumb=!0):this.resetMapa()}},methods:{initMapLayers:function(t){var a=this,e=this.mapa.getLayers().extend(t.map((function(t){return new ol.layer.Vector({style:a.defineStyle(t.id_tramitacao),source:new ol.source.Vector({url:"api".concat(r).concat(t.kml),format:new ol.format.KML({extractStyles:!1})}),updateWhileAnimating:!1,renderBuffer:100,renderMode:"image",id_projeto:t.id})})));this.activeLayers=e.array_},applyValuesInData:function(){this.center=this.view.getCenter(),this.zoom=this.view.getZoom()},applyMultiplyOnCanvas:function(){var t=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=function(t){return document.getElementsByTagName(t)[0]};null==e("canvas")&&a<30?setTimeout((function(){return t.applyMultiplyOnCanvas(a+1)}),2e3):e("canvas").getContext("2d").globalCompositeOperation="multiply"},toggleLayersStyles:function(t){this.activeLayers.forEach((function(a){var e=a.get("id_projeto");e===t?a.setOpacity(.7):e!==t&&e>0&&a.setOpacity(.05)}))},fitToLayer:function(t){var a=this.activeLayers.find((function(a){return a.get("id_projeto")===t})).getSource().getExtent();this.view.fit(a,{duration:1500})},defineStyle:function(t){var a={};return t<=3?(a.stroke="rgba(50, 50, 50, 0.5)",a.fill="rgba(255, 204, 179, 1)"):3<t&&t<=7?(a.stroke="rgba(50, 50, 50, 0.5)",a.fill="rgba(255, 85, 0, 1)"):7<t&&t<=8?(a.stroke="rgba(50, 50, 50, 0.5)",a.fill="rgba(128, 43, 0, 1)"):8<t&&t<=10?(a.stroke="rgba(50, 50, 50, 0.5)",a.fill="rgba(220, 220, 220, 1)"):(a.stroke="rgba(255, 85, 0, .5)",a.fill="rgba(200,200,200, 0)"),new ol.style.Style({stroke:new ol.style.Stroke({color:a.stroke,width:.75}),fill:new ol.style.Fill({color:a.fill})})},resetMapa:function(){this.activeLayers.forEach((function(t){(function(t){return t.get("id_projeto")})&&t.setOpacity(.6)})),this.view.animate({center:[-5195135.816167192,-2698303.8770360295],zoom:10.9,duration:1500}),this.$emit("clicked",0),this.breadcrumb=!1}}},i=e(17),s=Object(i.a)(n,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"mapa"}},[e("div",{staticClass:"title"},[e("h3",[t._v("Projetos de Intervenção Urbana")]),t._v(" "),t.breadcrumb?e("ul",{staticClass:"mapa_breadcrumb"},[e("li",[e("a",{attrs:{href:"#todos"},on:{click:t.resetMapa}},[t._v("PIUs")])]),t._v(" "),e("li",[t._v(t._s(t.tramitacaoProjetoSelecionado.nome))]),t._v(" "),e("li",[t._v(t._s(t.projetoSelecionado.nome))])]):t._e()]),t._v(" "),e("div",{staticClass:"downloadBase"},[e("a",{attrs:{href:t.fileDir+t.kmlSrc,id:"dlKml"}},[e("i",{staticClass:"material-icons"},[t._v("get_app")]),t._v(" KML\n\t\t\t")]),t._v(" "),e("a",{attrs:{href:t.fileDir+t.shpSrc,id:"dlShp"}},[e("i",{staticClass:"material-icons"},[t._v("get_app")]),t._v(" Shapefile\n\t\t\t")])]),t._v(" "),e("div",{staticClass:"map",attrs:{id:"map"}}),t._v(" "),e("div",{staticClass:"legenda"},[t.loading?e("span",[t._v("Carregando mapa...")]):[e("span",[t._v("Legenda")]),t._v(" "),e("div",{staticClass:"proposicao"},[t._v("Em proposição")]),t._v(" "),e("div",{staticClass:"andamento"},[t._v("Em andamento")]),t._v(" "),e("div",{staticClass:"implantacao"},[t._v("Implantação")]),t._v(" "),e("div",{staticClass:"suspenso"},[t._v("Suspenso/arquivado")])]],2)])}),[],!1,null,null,null);a.default=s.exports}}]);